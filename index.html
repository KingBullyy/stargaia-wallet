<!DOCTYPE html>
<html>
<head>
  <title>STARGAIA Wallet</title>
  <meta charset="UTF-8" />
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    body { background-color: #000814; color: #d1ffe2; font-family: Arial, sans-serif; text-align: center; padding: 2em; }
    button { padding: 10px 20px; background-color: #21f3b5; color: #000814; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; }
    .section { margin: 2em auto; padding: 1.5em; background-color: #010b1a; border-radius: 15px; max-width: 600px; }
    iframe { width: 100%; height: 300px; border: none; border-radius: 12px; background: #0a0a0a; }
  </style>
</head>
<body>
  <h1>🌌 STARGAIA Wallet Dashboard</h1>
  <button onclick="connectWallet()">Connect Wallet</button>

  <div class="section">
    <h2>🪙 GAIA Token Balance</h2>
    <p id="gaia-balance">0 GAIA</p>
  </div>

  <div class="section">
    <h2>🪪 Node License NFT</h2>
    <p id="nft-check">Not connected</p>
  </div>

  <div class="section">
    <h2>🛰️ Orbit Mapper</h2>
    <iframe src="https://cloudflare-ipfs.com/ipfs/bafkreig7uyql7ebkp5yima2qnmocdammq7rzrcaluajtdc2mcjllgj2mdi"></iframe>
  </div>

  <div class="section">
    <h2>📡 Signal Feed</h2>
    <iframe src="https://stargaia-signal-feed.blackmoneygangg.repl.co/update"></iframe>
  </div>

  <div class="section">
    <h2>💧 Request GAIA Tokens</h2>
    <p>Click below to get 10 GAIA test tokens</p>
    <button onclick="requestTokens()">Request GAIA</button>
    <p id="faucet-status" style="margin-top: 10px;"></p>
  </div>

  <script>
    const GAIA_ADDRESS = "0xd9145CCE52D386f254917e481eB44e9943F39138";
    const NODE_LICENSE_ADDRESS = "0x288Bf60BDb9C96800c8f99F445F66e001e90b8C3";
    const GAIA_ABI = [ "function balanceOf(address) view returns (uint256)" ];
    const NFT_ABI = [ "function balanceOf(address owner) view returns (uint256)" ];

    let provider, signer;

    async function connectWallet() {
      if (!window.ethereum) return alert("Install MetaMask");
      provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      signer = provider.getSigner();
      const address = await signer.getAddress();

      const gaia = new ethers.Contract(GAIA_ADDRESS, GAIA_ABI, provider);
      const balance = await gaia.balanceOf(address);
      document.getElementById("gaia-balance").innerText = ethers.utils.formatEther(balance) + " GAIA";

      const license = new ethers.Contract(NODE_LICENSE_ADDRESS, NFT_ABI, provider);
      const nftBalance = await license.balanceOf(address);
      document.getElementById("nft-check").innerText = nftBalance.toString() > 0 ? "✅ License Detected" : "❌ No License Found";
    }

    async function requestTokens() {
      if (!window.ethereum) return alert("Install MetaMask");
      const provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      const signer = provider.getSigner();
      const userAddress = await signer.getAddress();

      const gaia = new ethers.Contract(GAIA_ADDRESS, [
        "function transfer(address to, uint amount) public returns (bool)"
      ], signer);

      const tx = await gaia.transfer(userAddress, ethers.utils.parseEther("10"));
      document.getElementById("faucet-status").innerText = "Sending transaction...";
      await tx.wait();
      document.getElementById("faucet-status").innerText = "✅ 10 GAIA tokens sent!";
    }
  </script>
</body>
</html>
